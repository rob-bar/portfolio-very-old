function Saucer(a,b,c,d,e,f,g,h,i,j,k){function l(a){Debugger.log("drawSaucer");a.strokeStyle="#8c68e7";a.beginPath();a.moveTo(4,0);a.lineTo(9,0);a.lineTo(12,3);a.lineTo(13,3);a.moveTo(13,4);a.lineTo(10,7);a.lineTo(3,7);a.lineTo(1,5);a.lineTo(12,5);a.moveTo(0,4);a.lineTo(0,3);a.lineTo(13,3);a.moveTo(5,1);a.lineTo(5,2);a.moveTo(8,1);a.lineTo(8,2);a.moveTo(2,2);a.lineTo(4,0);a.stroke();a.closePath()}Debugger.log("Saucer");a===undefined?this.x=0:this.x=a;b===undefined?this.y=0:this.y=b;c===undefined?this.dx=0:this.dx=c;d===undefined?this.dy=0:this.dy=d;e===undefined?this.width=0:this.width=e;f===undefined?this.height=0:this.height=f;g===undefined?this.scoreValue=0:this.scoreValue=g;h===undefined?this.fireRate=0:this.fireRate=h;i===undefined?this.fireDelay=0:this.fireDelay=i;j===undefined?this.fireDelayCount=0:this.fireDelayCount=j;k===undefined?this.missileSpeed=0:this.missileSpeed=k;this.halfWidth=e*.5;this.halfHeight=f*.5;this.aSoucerMissiles=[];this.updateSaucer=function(a,b,c,d,e,f){this.fireDelayCount++;if(Math.floor(Math.random()*100)<=this.fireRate&&this.fireDelayCount>this.fireDelay){this.fireSaucerMissile(e,f);this.fireDelayCount=0}var g=false;this.x+=this.dx;this.y+=this.dy;if(this.dx>0&&this.x>b){g=true}else if(this.dx<0&&this.x<a-this.width){g=true}if(this.y>d||this.y<c-this.width){this.dy*=-1}return g};this.updateSaucerMissiles=function(a,b){var c={};var d=this.aSoucerMissiles.length-1;for(saucerMissileCtr=d;saucerMissileCtr>=0;saucerMissileCtr--){c=this.aSoucerMissiles[saucerMissileCtr];c.x+=c.dx;c.y+=c.dy;if(c.x>a)c.x=-c.width;else if(c.x<-c.width)c.x=a;if(c.y>b)c.y=-c.height;else if(c.y<-c.height)c.y=b;c.lifeCtr++;if(c.lifeCtr>c.life){this.aSoucerMissiles.splice(saucerMissileCtr,1);c=null}}};this.renderSaucer=function(a){a.save();a.setTransform(1,0,0,1,0,0);a.translate(this.x,this.y);l(a);a.restore()};this.renderSaucerMissiles=function(a){var b={};var c=this.aSoucerMissiles.length-1;for(saucerMissileCtr=c;saucerMissileCtr>=0;saucerMissileCtr--){b=this.aSoucerMissiles[saucerMissileCtr];a.save();a.setTransform(1,0,0,1,0,0);a.translate(b.x+1,b.y+1);a.strokeStyle="#FF0000";a.fillStyle="#FF0000";a.beginPath();a.fillRect(-1.5,-1.5,3,3);a.closePath();a.restore()}};this.fireSaucerMissile=function(a,b){var c={};c.x=this.x;c.y=this.y;c.width=2;c.height=2;c.speed=this.missileSpeed;var d=a-this.x;var e=b-this.y;var f=Math.atan2(e,d);var g=360*f/(2*Math.PI);c.dx=this.missileSpeed*Math.cos(angleToRadians(g));c.dy=this.missileSpeed*Math.sin(angleToRadians(g));c.life=160;c.lifeCtr=0;this.aSoucerMissiles.push(c)}}function Level(a,b,c,d,e,f,g,h){Debugger.log("Level");a===undefined?this.level=0:this.level=a;b===undefined?this.level_rock_max_speed_adjust=1:this.level_rock_max_speed_adjust=b;c===undefined?this.level_saucer_max=1:this.level_saucer_max=c;d===undefined?this.level_saucer_occurence_rate=25:this.level_saucer_occurence_rate=d;e===undefined?this.level_saucer_speed=1:this.level_saucer_speed=e;f===undefined?this.level_saucer_fire_delay=300:this.level_saucer_fire_delay=f;g===undefined?this.level_saucer_fire_rate=30:this.level_saucer_fire_rate=g;h===undefined?this.level_saucer_missile_speed=1:this.level_saucer_missile_speed=h;this.setLevelVariables=function(){this.level_rock_max_speed_adjust=this.level*.25;if(this.level_rock_max_speed_adjust>3)this.level_rock_max_speed_adjust=3;this.level_saucer_max=1+Math.floor(this.level/10);if(this.level_saucer_max>5)this.level_saucer_max=5;this.level_saucer_occurence_rate=10+3*this.level;if(this.level_saucer_occurence_rate>35)this.level_saucer_occurence_rate=35;this.level_saucer_speed=1+.5*this.level;if(this.level_saucer_speed>5)this.level_saucer_speed=5;this.level_saucer_fire_delay=120-10*this.level;if(this.level_saucer_fire_delay<20)this.level_saucer_fire_delay=20;this.level_saucer_fire_rate=20+3*this.level;if(this.level_saucer_fire_rate>50)this.level_saucer_fire_rate=50;this.level_saucer_missile_speed=1+.2*this.level;if(this.level_saucer_missile_speed>4)this.level_saucer_missile_speed=4};this.setLevelVariables()}function Particle(a,b,c,d,e){Debugger.log("Particle");a===undefined?this.x=0:this.x=a;b===undefined?this.y=0:this.y=b;c===undefined?this.dx=0:this.dx=c;d===undefined?this.dy=0:this.dy=d;e===undefined?this.life=Math.floor(Math.random()*30+30):this.life=e}function Player(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function s(a){Debugger.log("drawship");a.strokeStyle="#ffffff";a.beginPath();a.moveTo(-10,-10);a.lineTo(10,0);a.moveTo(10,1);a.lineTo(-10,10);a.lineTo(1,1);a.moveTo(1,-1);a.lineTo(-10,-10);a.stroke();a.closePath()}function r(a){Debugger.log("drawthrustedship");a.strokeStyle="#ffffff";a.fillStyle="#e67030";a.beginPath();a.moveTo(-10,-10);a.lineTo(10,0);a.moveTo(10,1);a.lineTo(-10,10);a.lineTo(1,1);a.moveTo(1,-1);a.lineTo(-10,-10);a.fillRect(-9,-1,6,2);a.stroke();a.closePath()}Debugger.log("Player");a===undefined?this.x=0:this.x=a;b===undefined?this.y=0:this.y=b;c===undefined?this.width=0:this.width=c;d===undefined?this.height=0:this.height=d;e===undefined?this.scale=1:this.scale=e;f===undefined?this.facingX=0:this.facingX=f;g===undefined?this.facingY=0:this.facingY=g;h===undefined?this.movingX=0:this.movingX=h;i===undefined?this.movingY=0:this.movingY=i;j===undefined?this.rotation=0:this.rotation=j;k===undefined?this.rotationVelocity=5:this.rotationVelocity=k;l===undefined?this.maxVelocity=2:this.maxVelocity=l;m===undefined?this.thrustAcceleration=.05:this.thrustAcceleration=m;n===undefined?this.missileFrameDelay=5:this.missileFrameDelay=n;o===undefined?this.thrust=false:this.thrust=o;p===undefined?this.friction=.001:this.friction=p;q===undefined?this.missileFrameCount=0:this.missileFrameCount=q;this.aPlayerMissiles=[];this.updatePlayer=function(a,b,c,d){this.missileFrameCount+=1;this.x+=this.movingX;this.y+=this.movingY;if(this.x>b)this.x=-this.width;else if(this.x<-this.width)this.x=b;if(this.y>d)this.y=-this.height;else if(this.y<-this.height)this.y=d};this.updatePlayerMissiles=function(a,b,c,d){var e={};var f=this.aPlayerMissiles.length-1;for(iplayerMissileCtr=f;iplayerMissileCtr>=0;iplayerMissileCtr--){e=this.aPlayerMissiles[iplayerMissileCtr];e.x+=e.dx;e.y+=e.dy;if(e.x>b)e.x=-e.width;else if(e.x<-e.width)e.x=b;if(e.y>d)e.y=-e.height;else if(e.y<-e.height)e.y=d;e.lifeCtr++;if(e.lifeCtr>e.life){this.aPlayerMissiles.splice(iplayerMissileCtr,1);e=null}}};this.renderPlayer=function(a){var b=angleToRadians(this.rotation);a.save();a.setTransform(1,0,0,1,0,0);a.translate(this.x+this.halfWidth,this.y+this.halfHeight);a.rotate(b);a.scale(this.scale,this.scale);this.thrust==true&&this.scale==1?r(a):s(a);a.restore()};this.renderPlayerMissiles=function(a){var b={};var c=this.aPlayerMissiles.length-1;for(iplayerMissileCtr=c;iplayerMissileCtr>=0;iplayerMissileCtr--){b=this.aPlayerMissiles[iplayerMissileCtr];a.save();a.setTransform(1,0,0,1,0,0);a.translate(b.x+1,b.y+1);a.strokeStyle="#e67030";a.fillStyle="#e67030";a.beginPath();a.fillRect(-1.5,-1.5,3,3);a.closePath();a.restore()}}}function Rock(a,b,c,d,e,f,g,h){Debugger.log("Rock");b===undefined?this.x=0:this.x=b;c===undefined?this.y=0:this.y=c;d===undefined?this.dx=0:this.dx=d;e===undefined?this.dy=0:this.dy=e;f===undefined?this.rotation=0:this.rotation=f;g===undefined?this.rotationInc=0:this.rotationInc=g;h===undefined?this.scoreValue=0:this.scoreValue=h;a===undefined?this.scale=0:this.scale=a;this.scale<1||this.scale>3?this.scale=1:this.scale=a;switch(this.scale){case 1:this.width=50;this.height=50;break;case 2:this.width=25;this.height=25;break;case 3:this.width=16;this.height=16;break;default:break}this.halfWidth=this.width*.5;this.halfHeight=this.height*.5}Rock.prototype.update=function(a,b,c,d){this.x+=this.dx;this.y+=this.dy;this.rotation+=this.rotationInc;if(this.x>b)this.x=-this.width;else if(this.x<-this.width)this.x=b;if(this.y>d)this.y=-this.height;else if(this.y<-this.height)this.y=d};Rock.prototype.draw=function(a){var b=angleToRadians(this.rotation);a.save();a.setTransform(1,0,0,1,0,0);a.translate(this.x+this.halfWidth,this.y+this.halfHeight);a.rotate(b);a.strokeStyle="#FFFFFF";a.beginPath();a.moveTo(-(this.halfWidth-1),-(this.halfHeight-1));a.lineTo(this.halfWidth-1,-(this.halfHeight-1));a.lineTo(this.halfWidth-1,this.halfHeight-1);a.lineTo(-(this.halfWidth-1),this.halfHeight-1);a.lineTo(-(this.halfWidth-1),-(this.halfHeight-1));a.stroke();a.closePath();a.restore()};Player.prototype.update=function(a,b,c,d){this.updatePlayer(a,b,c,d);this.updatePlayerMissiles(a,b,c,d)};Player.prototype.render=function(a){this.renderPlayer(a);this.renderPlayerMissiles(a)};Player.prototype.firePlayerMissile=function(){var a={};a.dx=5*Math.cos(Math.PI*this.rotation/180);a.dy=5*Math.sin(Math.PI*this.rotation/180);a.x=this.x+this.halfWidth;a.y=this.y+this.halfHeight;a.life=80;a.lifeCtr=0;a.width=2;a.height=2;this.aPlayerMissiles.push(a)};Player.prototype.resetPlayer=function(a,b){this.rotation=270;this.aPlayerMissiles=[];this.x=.5*a;this.y=.5*b;this.thrust=false;this.facingX=0;this.facingY=0;this.movingX=0;this.movingY=0;this.alpha=0;this.missileFrameCount=0};Particle.prototype.update=function(a,b,c,d){var e=false;this.x+=this.dx;this.y+=this.dy;this.lifeCtr+=1;try{if(this.lifeCtr>this.life){e=true}else if(this.x>b||this.x<a||this.y>d||this.y<c){e=true}}catch(f){Debugger.log("Error in particle");Debugger.log("particle: "+f)}return e};Particle.prototype.render=function(a){a.save();a.setTransform(1,0,0,1,0,0);a.translate(this.x,this.y);a.strokeStyle="#cb6b6b";a.lineWidth=2;a.beginPath();a.moveTo(0,0);a.lineTo(1,1);a.stroke();a.closePath();a.restore()};Level.prototype.up=function(){this.level+=1;this.setLevelVariables()};Level.prototype.reset=function(){this.level=0;this.setLevelVariables()};Saucer.prototype.update=function(a,b,c,d,e,f){var g=this.updateSaucer(a,b,c,d,e,f);this.updateSaucerMissiles(b,d);return g};Saucer.prototype.render=function(a){this.renderSaucer(a);this.renderSaucerMissiles(a)};$(document).ready(function(){function bq(a,b,c){Debugger.log("splitRock");for(rockCtr=0;rockCtr<2;rockCtr++){var d=new Rock(a);if(a==2){d.scoreValue=x}else{d.scoreValue=y}d.x=b;d.y=c;d.dx=Math.random()*3;if(Math.random()<.5)d.dx*=-1;d.dy=Math.random()*3;if(Math.random()<.5)d.dy*=-1;d.rotationInc=Math.random()*5+1;if(Math.random()<.5)d.rotationInc*=-1;d.rotation=0;F.push(d)}}function bp(a,b,c){Debugger.log("createExplode");for(var d=0;d<c;d++){var e=new Particle;e.dx=Math.random()*3;if(Math.random()<.5)e.dx*=-1;e.dy=Math.random()*3;if(Math.random()<.5)e.dy*=-1;e.lifeCtr=0;e.x=a;e.y=b;H.push(e)}}function bo(a){o+=a}function bn(){Debugger.log("playerDie");bp(D.x+D.halfWidth,D.y+D.halfHeight,50);X(f)}function bm(){Debugger.log("checkCollisions");var a={};var b=F.length-1;var c={};var d=D.aPlayerMissiles.length-1;var e=G.length-1;var f={};rocksing:for(var g=b;g>=0;g--){a=F[g];missilesing:for(var h=d;h>=0;h--){c=D.aPlayerMissiles[h];if(boundingBoxCollide(a,c)){Debugger.log("hit Rock Missile");bp(a.x+a.halfWidth,a.y+a.halfHeight,10);if(a.scale<3)bq(a.scale+1,a.x,a.y);bo(a.scoreValue);D.aPlayerMissiles.splice(h,1);c=null;F.splice(g,1);a=null;break rocksing;break missilesing}}saucering:for(var i=e;i>=0;i--){f=G[i];if(boundingBoxCollide(a,f)){Debugger.log("hit Rock saucer");bp(f.x+f.halfWidth,f.y+f.halfHeight,10);bp(a.x+a.halfWidth,a.y+a.halfHeight,10);if(a.scale<3)bq(a.scale+1,a.x,a.y);G.splice(i,1);f=null;F.splice(g,1);a=null;break rocksing;break saucering}var j=f.aSoucerMissiles.length-1;saucerMissilesing:for(var k=j;k>=0;k--){tempSaucerMissile=f.aSoucerMissiles[k];if(boundingBoxCollide(a,tempSaucerMissile)){Debugger.log("hit Rock saucerMissiles:");bp(a.x+a.halfWidth,a.y+a.halfHeight,10);if(a.scale<3)bq(a.scale+1,a.x,a.y);f.aSoucerMissiles.splice(k,1);tempSaucerMissile=null;F.splice(g,1);a=null;break rocksing;break saucerMissilesing}}}if(boundingBoxCollide(a,D)){bp(a.x+a.halfWidth,a.y+a.halfHeight,10);bo(a.scoreValue);if(a.scale<3)bq(a.scale+1,a.x,a.y);F.splice(g,1);a=null;bn()}}playerMissilesLength=D.aPlayerMissiles.length-1;e=G.length-1;saucersying:for(i=e;i>=0;i--){f=G[i];missilesying:for(h=playerMissilesLength;h>=0;h--){c=D.aPlayerMissiles[h];if(boundingBoxCollide(f,c)){Debugger.log("h");bp(f.x+f.halfWidth,f.y+f.halfHeight,10);bo(f.scoreValue);D.aPlayerMissiles.splice(h,1);c=null;G.splice(i,1);f=null;break saucersying;break missilesying}}if(boundingBoxCollide(f,D)){Debugger.log("hit Saucers player");bp(f.x+16,f.y+16,10);bo(f.scoreValue);G.splice(i,1);f=null;bn()}j=f.aSoucerMissiles.length-1;saucerMissilesYeah:for(k=j;k>=0;k--){tempSaucerMissile=f.aSoucerMissiles[k];if(boundingBoxCollide(D,tempSaucerMissile)){Debugger.log("hit saucermissile player");bn();f.aSoucerMissiles.splice(k,1);tempSaucerMissile=null;break saucerMissilesYeah}}}}function bl(){Debugger.log("renderParticles");var a={};var b=H.length-1;for(var c=b;c>=0;c--){a=H[c];a.render(L)}}function bk(){Debugger.log("renderSaucers");var a={};var b=G.length-1;for(saucerCtr=b;saucerCtr>=0;saucerCtr--){a=G[saucerCtr];a.render(L)}}function bj(){Debugger.log("renderRocks");var a={};var b=F.length-1;for(rockCtr=b;rockCtr>=0;rockCtr--){a=F[rockCtr];a.draw(L)}}function bi(){D.render(L)}function bh(){Debugger.log("updateParticles");var a={};var b=H.length-1;for(particleCtr=b;particleCtr>=0;particleCtr--){a=H[particleCtr];if(a.update()){H.splice(particleCtr,1);a=null}}}function bg(){Debugger.log("updateSaucers");if(G.length<I.level_saucer_max){if(Math.floor(Math.random()*100)<=I.level_saucer_occurence_rate){var a=new Saucer(0,0,0,0,28,13,z,I.level_saucer_fire_rate,I.level_saucer_fire_delay,0,I.level_saucer_missile_speed);a.dy=Math.random()*2;if(Math.floor(Math.random()*2)==1)a.dy*=-1;if(Math.floor(Math.random()*2)==1){a.x=t+a.width;a.dx=-1*I.level_saucer_speed}else{a.x=-a.width;a.dx=I.level_saucer_speed}a.y=Math.floor(Math.random()*t-a.height);G.push(a)}}var b={};var c=G.length-1;for(saucerCtr=c;saucerCtr>=0;saucerCtr--){b=G[saucerCtr];if(b.update(s,t,u,v,D.x,D.y)){G.splice(saucerCtr,1);b=null}}}function bf(){Debugger.log("updateRocks");var a=F.length-1;for(rockCtr=a;rockCtr>=0;rockCtr--){var b=F[rockCtr];b.update(s,t,u,v)}}function be(){Debugger.log("updatePlayer");D.update(s,t,u,v)}function bd(){Debugger.log("resetPlayer");D.resetPlayer(t,v)}function bc(){Debugger.log("checkForEndOfLevel");if(F.length==0)X(c)}function bb(){Debugger.log("checkForExtraShips");if(Math.floor(o/p)>q){r+=1;q+=1}}function ba(){}function _(){Debugger.log("renderScoreboard");L.fillStyle="#ffffff";L.textAlign="left";L.fillText("Score - "+o,20,20);E.x=t*.5-32;E.y=16;E.width=20;E.height=20;E.halfWidth=E.width*.5;E.halfHeight=E.height*.5;E.rotation=270;E.scale=.75;E.render(L);L.textAlign="center";L.fillText("X "+r,t*.5,20);L.fillText("level: "+I.level,t-50,20);ba()}function Z(){Debugger.log("setTExtStyle");L.fillStyle="#ffffff";L.font="16px Calibri";L.textAlign="center";L.textBaseline="top"}function Y(){Debugger.log("fillBackground");L.fillStyle="#000000";L.fillRect(s,u,t,v)}function X(h){k=h;switch(k){case a:l=V;break;case b:l=P;break;case c:l=Q;break;case d:l=R;break;case e:l=S;break;case f:l=T;break;case g:l=U;break}}function W(){l()}function V(){if(m!=true){Debugger.log("gameStateTitle");Y();Z();L.fillText("Geo Blaster Basic",t*.5,70);L.fillText("Press Spacebar To Play",t*.5,140);L.fillText("Use arrow keys to move your Ship.",t*.5,165);L.fillText("Use Spacebar to Fire.",t*.5,185);m=true}else{if(J[32]==true){Debugger.log("Space Pressed");X(b);m=false}}}function U(){Debugger.log("gameStateGameOver");if(n==false){Y();_();Z();L.fillStyle="#FF0000";L.fillText("Game Over!",t*.5,70);L.fillText("Press Space To Play",t*.5,140);n=true}else{if(J[32]==true){Debugger.log("Space pressed");X(a);n=false}}}function T(){Debugger.log("gameStatePlayerDie");if(H.length>0||D.aPlayerMissiles.length>0){Y();_();bf();bg();bh();D.updatePlayerMissiles(s,t,u,v);bj();bk();bl();D.renderPlayerMissiles(L);frameRateCounter.countFrames()}else{r-=1;if(r==0){X(g)}else{bd();X(d)}}}function S(){Debugger.log("gameStatePlayelevel");M();N();O();bm();bb();bc();frameRateCounter.countFrames()}function R(){Debugger.log("gameStatePlayerStart");Y();_();if(D.alpha<1){D.alpha+=.02;L.globalAlpha=D.alpha}else{X(e)}bi(D.x,D.y,270,1);L.alpha=1;bf();bj()}function Q(){Debugger.log("gameStateNewLevel");F=[];G=[];H=[];I.up();for(i=0;i<I.level+3;i++){var a=new Rock(1);a.x=Math.floor(Math.random()*t);a.y=Math.floor(Math.random()*v);a.dx=Math.floor(Math.random()*2+I.level_rock_max_speed_adjust);if(Math.random()<.5)a.dx=-1;a.dy=Math.floor(Math.random()*2+I.level_rock_max_speed_adjust);if(Math.random()<.5)a.dy=-1;a.rotationInc=Math.random()*5+1;if(Math.random()<.5)a.rotationInc*=-1;a.scoreValue=w;a.rotation=0;F.push(a)}bd();X(d)}function P(){Debugger.log("gameStateNewGame");o=0;r=3;I.reset();D.maxVelocity=2;D.width=20;D.height=20;D.scale=1;D.alpha=0;D.halfWidth=D.width*.5;D.halfHeight=D.height*.5;D.rotationalVelocity=5;D.thrustAcceleration=.05;D.missileFrameDelay=5;D.thrust=false;D.friction=.001;Y();_();X(c)}function O(){Y();_();bi();bj();bk();bl()}function N(){be();bf();bg();bh()}function M(){if(J[38]==true){D.facingX=Math.cos(angleToRadians(D.rotation));D.facingY=Math.sin(angleToRadians(D.rotation));var a=D.movingX+D.thrustAcceleration*D.facingX;var b=D.movingY+D.thrustAcceleration*D.facingY;var c=Math.sqrt(a*a+b*b);if(c<D.maxVelocity){Debugger.log("curentVelocity => "+c);D.movingX=a;D.movingY=b}D.thrust=true}else{D.thrust=false;D.movingX-=D.movingX*D.friction;D.movingY-=D.movingY*D.friction}if(J[37]==true){D.rotation-=D.rotationalVelocity}if(J[39]==true){D.rotation+=D.rotationalVelocity}if(J[32]==true){Debugger.log("player.missileFrameCount => "+D.missileFrameCount);Debugger.log("player.missileFrameDelay => "+D.missileFrameDelay);if(D.missileFrameCount>D.missileFrameDelay){D.firePlayerMissile();D.missileFrameCount=0}}}const a=0;const b=1;const c=2;const d=3;const e=4;const f=5;const g=6;const h=60;var j=0;var k=0;var l=null;var m=false;var n=false;var o=0;var p=1e4;var q=0;var r=3;var s=0;var t=1024;var u=0;var v=600;var w=50;var x=75;var y=100;var z=300;const A=1;const B=2;const C=3;var D=new Player;var E=new Player;var F=[];var G=[];var H=[];var I=new Level(1);var J=[];if(!canvasSupport()||jQuery.browser.msie){$("#browser-error").css("display","block");$("#canvas").css("display","none");return}else{var K=document.getElementById("canvas");var L=K.getContext("2d");Debugger.isTracing=false;frameRateCounter=new FrameRateCounter;X(a);j=setInterval(W,getMillisecondsInterval(h))}Debugger.log("This browsers support for canvas is "+canvasSupport());$(document).keydown(function(a){J[a.keyCode]=true});$(document).keyup(function(a){J[a.keyCode]=false})})